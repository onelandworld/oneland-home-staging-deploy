"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8997],{49637:function(e,t,s){s.d(t,{A:function(){return c},C:function(){return a},R:function(){return l},S:function(){return m},U:function(){return g},a:function(){return d},b:function(){return u}});var i=s(42009),n=s(6475),r=s(65007);class a extends r.Z{constructor(e){let{chains:t=n.gL9,options:s}=e;super(),(0,i._)(this,"id",void 0),(0,i._)(this,"name",void 0),(0,i._)(this,"chains",void 0),(0,i._)(this,"options",void 0),(0,i._)(this,"ready",void 0),this.chains=t,this.options=s}getBlockExplorerUrls(e){let t=e.explorers?.map(e=>e.url)??[];return t.length>0?t:void 0}isChainUnsupported(e){return!this.chains.some(t=>t.chainId===e)}updateChains(e){this.chains=e}}class h extends Error{constructor(e,t){let{cause:s,code:n,data:r}=t;if(!Number.isInteger(n))throw Error('"code" must be an integer.');if(!e||"string"!=typeof e)throw Error('"message" must be a nonempty string.');super(e),(0,i._)(this,"cause",void 0),(0,i._)(this,"code",void 0),(0,i._)(this,"data",void 0),this.cause=s,this.code=n,this.data=r}}class o extends h{constructor(e,t){let{cause:s,code:i,data:n}=t;if(!(Number.isInteger(i)&&i>=1e3&&i<=4999))throw Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,{cause:s,code:i,data:n})}}class c extends Error{constructor(){super(...arguments),(0,i._)(this,"name","AddChainError"),(0,i._)(this,"message","Error adding chain")}}class d extends Error{constructor(e){let{chainId:t,connectorId:s}=e;super(`Chain "${t}" not configured for connector "${s}".`),(0,i._)(this,"name","ChainNotConfigured")}}class u extends Error{constructor(){super(...arguments),(0,i._)(this,"name","ConnectorNotFoundError"),(0,i._)(this,"message","Connector not found")}}class l extends h{constructor(e){super("Resource unavailable",{cause:e,code:-32002}),(0,i._)(this,"name","ResourceUnavailable")}}class m extends o{constructor(e){super("Error switching chain",{cause:e,code:4902}),(0,i._)(this,"name","SwitchChainError")}}class g extends o{constructor(e){super("User rejected request",{cause:e,code:4001}),(0,i._)(this,"name","UserRejectedRequestError")}}},4646:function(e,t,s){s.d(t,{n:function(){return i}});function i(e){return"string"==typeof e?Number.parseInt(e,"0x"===e.trim().substring(0,2)?16:10):"bigint"==typeof e?Number(e):e}},38997:function(e,t,s){s.r(t),s.d(t,{WalletConnectV1Connector:function(){return C}});var i=s(43290),n=s(87039),r=s(42009),a=s(19485),h=s(71210),o=s(16441),c=s(49637),d=s(4646);s(65007);let u="last-used-chain-id",l="last-session";var m=new WeakMap,g=new WeakMap,p=new WeakSet,w=new WeakSet;class C extends c.C{constructor(e){super(e),(0,i._)(this,w),(0,i._)(this,p),(0,r._)(this,"id","walletConnectV1"),(0,r._)(this,"name","WalletConnectV1"),(0,r._)(this,"ready",!0),(0,n._)(this,m,{writable:!0,value:void 0}),(0,n._)(this,g,{writable:!0,value:void 0}),(0,r._)(this,"walletName",void 0),(0,r._)(this,"onSwitchChain",()=>{this.emit("message",{type:"switch_chain"})}),(0,r._)(this,"onDisplayUri",async(e,t)=>{e&&this.emit("message",{data:e,type:"display_uri_error"}),this.emit("message",{data:t.params[0],type:"display_uri"})}),(0,r._)(this,"onRequestSent",(e,t)=>{e&&this.emit("message",{data:e,type:"request"}),this.emit("message",{data:t.params[0],type:"request"})}),(0,r._)(this,"onMessage",e=>{this.emit("message",e)}),(0,r._)(this,"onAccountsChanged",e=>{0===e.length?this.emit("disconnect"):this.emit("change",{account:a.getAddress(e[0])})}),(0,r._)(this,"onChainChanged",e=>{let t=(0,d.n)(e),s=this.isChainUnsupported(t);(0,n.b)(this,g).setItem(u,String(e)),this.emit("change",{chain:{id:t,unsupported:s}})}),(0,r._)(this,"onDisconnect",async()=>{this.walletName=void 0,(0,n.b)(this,g).removeItem(u),(0,n.b)(this,g).removeItem(l),(0,i.a)(this,w,v).call(this),this.emit("disconnect")}),(0,n.a)(this,g,e.storage)}async connect(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=e;if(!t){let s=await (0,n.b)(this,g).getItem(u),r=s?parseInt(s):void 0;r&&!this.isChainUnsupported(r)&&(t=r)}let o=await this.getProvider({chainId:t,create:!0});this.setupListeners(),setTimeout(()=>this.emit("message",{type:"connecting"}),0);let d=await o.enable(),l=a.getAddress(d[0]),m=await this.getChainId(),w=this.isChainUnsupported(m);if(this.walletName=o.connector?.peerMeta?.name??"",e)try{await this.switchChain(e),m=e,w=this.isChainUnsupported(m)}catch(C){console.error(`could not switch to desired chain id: ${e} `,C)}return(0,i.a)(this,p,_).call(this),this.emit("connect",{account:l,chain:{id:m,unsupported:w},provider:o}),{account:l,chain:{id:m,unsupported:w},provider:new h.Q(o)}}catch(v){if(/user closed modal/i.test(v.message))throw new c.U(v);throw v}}async disconnect(){let e=await this.getProvider();await e.disconnect()}async getAccount(){let e=await this.getProvider(),t=e.accounts;return a.getAddress(t[0])}async getChainId(){let e=await this.getProvider(),t=(0,d.n)(e.chainId);return t}async getProvider(){let{chainId:e,create:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(0,n.b)(this,m)||e||t){let i=this.options?.infuraId?{}:this.chains.reduce((e,t)=>({...e,[t.chainId]:t.rpc[0]}),{}),r=(await Promise.all([s.e(2592),s.e(9294),s.e(971)]).then(s.bind(s,80971))).default,a=await (0,n.b)(this,g).getItem(l),h=a?JSON.parse(a):void 0;this.walletName=h?.peerMeta?.name||void 0,(0,n.a)(this,m,new r({...this.options,chainId:e,rpc:{...i,...this.options?.rpc},session:h||void 0}))}return(0,n.b)(this,m)}async getSigner(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=await Promise.all([this.getProvider({chainId:e}),this.getAccount()]);return new h.Q(t,e).getSigner(s)}async isAuthorized(){try{let e=await this.getAccount();return!!e}catch{return!1}}async switchChain(e){let t=await this.getProvider(),s=o.hexValue(e);try{return await Promise.race([t.request({method:"wallet_switchEthereumChain",params:[{chainId:s}]}),new Promise(t=>this.on("change",s=>{let{chain:i}=s;i?.id===e&&t(e)}))]),this.chains.find(t=>t.chainId===e)??{chainId:e,name:`Chain ${s}`,network:`${s}`,nativeCurrency:{name:"Ether",decimals:18,symbol:"ETH"},rpc:[""],shortName:"eth",chain:"ETH",slug:"ethereum",testnet:!1}}catch(a){let i="string"==typeof a?a:a?.message;if(/user rejected request/i.test(i))throw new c.U(a);let n=this.chains.find(t=>t.chainId===e);if(!n)throw new c.S(`Chain ${e} is not added in the list of supported chains`);if(console.log({chain:n}),/Unrecognized chain ID/i.test(i)){this.emit("message",{type:"add_chain"});let r=this.getBlockExplorerUrls(n);return await t.request({method:"wallet_addEthereumChain",params:[{chainId:s,chainName:n.name,nativeCurrency:n.nativeCurrency,rpcUrls:n.rpc,blockExplorerUrls:r}]}),n}throw new c.S(a)}}async setupListeners(){(0,n.b)(this,m)&&((0,n.b)(this,m).on("accountsChanged",this.onAccountsChanged),(0,n.b)(this,m).on("chainChanged",this.onChainChanged),(0,n.b)(this,m).on("disconnect",this.onDisconnect),(0,n.b)(this,m).on("message",this.onMessage),(0,n.b)(this,m).on("switchChain",this.onSwitchChain),(0,n.b)(this,m).on("display_uri",this.onDisplayUri),(0,n.b)(this,m).on("call_request_sent",this.onRequestSent))}}async function _(){let e=n.b(this,m)?.connector.session;this.walletName=e?.peerMeta?.name||"";let t=JSON.stringify(e);(0,n.b)(this,g).setItem(l,t)}function v(){(0,n.b)(this,m)&&((0,n.b)(this,m).removeListener("accountsChanged",this.onAccountsChanged),(0,n.b)(this,m).removeListener("chainChanged",this.onChainChanged),(0,n.b)(this,m).removeListener("disconnect",this.onDisconnect),(0,n.b)(this,m).removeListener("message",this.onMessage),(0,n.b)(this,m).removeListener("switchChain",this.onSwitchChain),(0,n.b)(this,m).removeListener("display_uri",this.onDisplayUri),(0,n.b)(this,m).removeListener("call_request_sent",this.onRequestSent))}}}]);